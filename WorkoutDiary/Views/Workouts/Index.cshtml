@model List<WorkoutDiary.Models.Workout>
@{
    ViewData["Title"] = "Дневник тренировок";
}

<div style="display: flex;">
    <!-- Календарь -->
    <div style="width: 30%; padding: 10px;">
        <h3>Выберите дату</h3>
        <form asp-action="Index" method="get">
            <input type="date" name="date" value="@ViewBag.SelectedDate.ToString("yyyy-MM-dd")" onchange="this.form.submit()" />
        </form>
    </div>

    <!-- Список тренировок -->
    <div style="width: 70%; padding: 10px;">
        <h2>Тренировки за @ViewBag.SelectedDate.ToString("yyyy-MM-dd")</h2>

        <!-- Форма для создания новой тренировки -->
        <h3>Добавить тренировку</h3>
        <form asp-action="Create" method="post">
            <input type="hidden" name="Date" value="@ViewBag.SelectedDate.ToString("yyyy-MM-dd")" />
            <textarea name="Note" placeholder="Заметка" rows="3" cols="50"></textarea>
            <br />
            <button type="submit">Сохранить</button>
        </form>

        <!-- Список тренировок -->
        @foreach (var workout in Model)
        {
            <div style="border: 1px solid #ccc; margin: 10px 0; padding: 10px;">
                <h3>Тренировка #@workout.Id</h3>
                <p>@workout.Note</p>
                <h4>Упражнения:</h4>
                <ul>
                    @foreach (var we in workout.WorkoutExercises)
                    {
                        <li>
                            @we.Exercise.Name - Подходы: @we.Sets, Повторения: @we.Reps, Вес: @we.Weight кг
                            <a asp-action="EditExercise" asp-route-id="@we.Id">Редактировать</a> |
                            <a asp-action="DeleteExercise" asp-route-id="@we.Id" onclick="return confirm('Вы уверены, что хотите удалить это упражнение?')">Удалить</a>
                        </li>
                    }
                </ul>

                <!-- Форма для добавления упражнения -->
                <form asp-action="AddExercise" method="post">
                    <input type="hidden" name="workoutId" value="@workout.Id" />
                    <select name="exerciseId">
                        @foreach (var exercise in ViewBag.Exercises)
                        {
                            <option value="@exercise.Id">@exercise.Name</option>
                        }
                    </select>
                    <input type="number" name="sets" placeholder="Подходы" required min="1" />
                    <input type="number" name="reps" placeholder="Повторения" required min="1" />
                    <input type="number" name="weight" placeholder="Вес (кг)" step="0.1" required min="0" />
                    <button type="submit">Добавить</button>
                </form>

                <!-- Кнопки редактирования и удаления тренировки -->
                <div style="margin-top: 10px;">
                    <a asp-action="Edit" asp-route-id="@workout.Id">Редактировать</a> |
                    <a asp-action="Delete" asp-route-id="@workout.Id" onclick="return confirm('Вы уверены, что хотите удалить эту тренировку?')">Удалить</a>
                </div>
            </div>
        }
    </div>
</div>